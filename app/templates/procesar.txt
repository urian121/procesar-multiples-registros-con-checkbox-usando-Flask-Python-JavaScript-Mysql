
/**
 * Procesar todos los checkbox seleccionados para ser movidos a bandeja de leidos
 */
let btnProcesar = document.querySelector("#my-button");
btnProcesar.addEventListener("click", async function (event) {
  event.preventDefault(); // Evitar que el formulario se envíe automáticamente

  const formData = new FormData(document.getElementById("my-form"));
  console.log(formData);
  try {
    const response = await fetch("/procesar-checkbox-consignaciones", {
      method: "POST",
      body: formData,
    });

    if (response.ok) {
      /*
       * Convirtiendo la respuesta en formato JSON ya que desde
       * el servidor le estoy enviando una respuesta en formato JSON
       */
      const jsonResponse = await response.json();
      if (jsonResponse && jsonResponse.idsProcesados) {
        let idsConsig = jsonResponse.idsProcesados;
        //console.log("IDs procesados:", jsonResponse.idsProcesados);

        idsConsig.forEach((idElement) => {
          document.querySelector("#filaIdConsignacion_" + idElement).remove();
        });

        successfull("la acción fue ejecutada con éxito");
      } else {
        console.log("La respuesta del servidor no es válida.");
      }
    } else {
      console.log("Error al procesar el formulario: " + response.status);
    }
  } catch (error) {
    console.log("Error al procesar el formulario:", error);
  } finally {
    console.log("peticion finalizada.");
  }
});